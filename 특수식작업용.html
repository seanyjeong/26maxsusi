<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íŠ¹ìˆ˜ ê³„ì‚°ì‹ ì ìš© ëŒ€í•™ ë¦¬ìŠ¤íŠ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; background: #f6f8fa; max-width: 900px; margin: 0 auto; padding: 30px 10px;}
    h2 { color: #4364f7; margin-bottom: 25px; font-weight: 700;}
    table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.05);}
    th, td { padding: 12px 10px; border-bottom: 1px solid #e9ecef; text-align: center;}
    th { background: #f4f7fe; color: #333; font-weight: 600;}
    tbody tr:last-child td { border-bottom: none; }
    .desc { color: #2c3e50; font-size: 0.98em; text-align: left;}
    .type-badge { background: #4364f7; color: #fff; padding: 4px 10px; border-radius: 12px; font-size: 0.85em; font-weight: 500; display: inline-block;}
    .ckbox { width: 20px; height: 20px; }
  </style>
</head>
<body>
  <h2>ğŸ¯ íŠ¹ìˆ˜ ê³„ì‚°ì‹ ì ìš© ëŒ€í•™ ë¦¬ìŠ¤íŠ¸</h2>
  <table>
    <thead>
      <tr>
        <th>No</th>
          <th>ëŒ€í•™ID</th> <!-- ì¶”ê°€ -->
        <th>ì„ íƒ</th>
        <th>ëŒ€í•™ëª…</th>
        <th>í•™ê³¼ëª…</th>
        <th>ì „í˜•ëª…</th>
        <th>í™˜ì‚°ë°©ì‹</th>
        <th>íŠ¹ìˆ˜ì‹ ì„¤ëª…</th>
      </tr>
    </thead>
    <tbody id="specialBody">
      <tr><td colspan="7">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>
    </tbody>
  </table>

  <script>
    const SERVER = 'https://supermax.kr';
    const STORAGE_KEY = 'special_college_checked';

    // ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
    function getCheckedSet() {
      try {
        return new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'));
      } catch { return new Set(); }
    }
    function saveCheckedSet(set) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(set)));
    }

    async function loadSpecialColleges() {
      const res = await fetch(SERVER + '/26susi_get_practical_colleges_with_scores');
      const colleges = await res.json();
      const tbody = document.getElementById('specialBody');
      const checkedSet = getCheckedSet();

      const specialColleges = colleges.filter(c =>
        (c.í™˜ì‚°ë°©ì‹ && c.í™˜ì‚°ë°©ì‹ !== 'ë¹„ìœ¨í™˜ì‚°') ||
        (c.íŠ¹ìˆ˜ì‹ì„¤ëª… && c.íŠ¹ìˆ˜ì‹ì„¤ëª….trim() !== '')
      );

      if (!specialColleges.length) {
        tbody.innerHTML = '<tr><td colspan="7">íŠ¹ìˆ˜ì‹ ì ìš© ëŒ€í•™ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        return;
      }

      tbody.innerHTML = '';
      specialColleges.forEach((c, idx) => {
        // ì²´í¬ë°•ìŠ¤ keyëŠ” "ëŒ€í•™ID-í•™ê³¼ëª…-ì „í˜•ëª…"ìœ¼ë¡œ ê³ ìœ ì„± ë¶€ì—¬
        const rowKey = [c.ëŒ€í•™ID, c.í•™ê³¼ëª…, c.ì „í˜•ëª…].join('|');
        const checked = checkedSet.has(rowKey) ? 'checked' : '';
        tbody.innerHTML += `
          <tr>
            <td>${idx + 1}</td>
              <td>${c.ëŒ€í•™ID}</td> <!-- ì¶”ê°€ -->
            <td>
              <input type="checkbox" class="ckbox" data-key="${rowKey}" ${checked}>
            </td>
            <td>${c.ëŒ€í•™ëª…}</td>
            <td>${c.í•™ê³¼ëª… || '-'}</td>
            <td>${c.ì „í˜•ëª… || '-'}</td>
            <td>${c.í™˜ì‚°ë°©ì‹ || '-'}</td>
            <td class="desc">${c.íŠ¹ìˆ˜ì‹ì„¤ëª… || '-'}</td>
          </tr>
        `;
      });

      // ì´ë²¤íŠ¸ ì—°ê²° (ë™ì  ë Œë” í›„!)
      document.querySelectorAll('.ckbox').forEach(cb => {
        cb.addEventListener('change', function() {
          const key = this.dataset.key;
          const set = getCheckedSet();
          if (this.checked) set.add(key);
          else set.delete(key);
          saveCheckedSet(set);
        });
      });
    }

    loadSpecialColleges();
  </script>
</body>
</html>
